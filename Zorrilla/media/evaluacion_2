select c.first_name, c.last_name from customer as c;

select customer_id, count(rental_id) from rental group by customer_id;

select customer_id, sum(amount) from payment where group by customer_id;

1)
select c.first_name, c.last_name, count(r.rental_id) as "Cantidad de peliculas", sum(p.amount) as "Dinero gastado" from payment as p inner join rental as r on p.rental_id = r.rental_id inner join customer as c on p.customer_id = c.customer_id group by p.customer_id having sum(p.amount) between 100 and 150;

2)
select co.country, ca.name, count(fc.category_id) from rental as r inner join inventory as i on r.inventory_id = i.inventory_id inner join film_category as fc on i.film_id = fc.film_id inner join customer as c on r.customer_id = c.customer_id inner join address as a on c.address_id = a.address_id inner join city as ci on a.city_id = ci.city_id inner join country as co on ci.country_id = co.country_id inner join film as f on fc.film_id = f.film_id inner join category as ca on fc.category_id = ca.category_id group by co.country, ca.category_id;

3)
select ca.name, c.customer_id, r.return_date from rental as r inner join inventory as i on r.inventory_id = i.inventory_id inner join film_category as fc on i.film_id = fc.film_id inner join category as ca on fc.category_id = ca.category_id inner join customer as c on r.customer_id = c.customer_id where r.return_date is null order by ca.name;

select ca.name, count(c.customer_id), r.return_date from rental as r inner join inventory as i on r.inventory_id = i.inventory_id inner join film_category as fc on i.film_id = fc.film_id inner join category as ca on fc.category_id = ca.category_id inner join customer as c on r.customer_id = c.customer_id where r.return_date is null;





4)
select a.actor_id, a.first_name, a.last_name, c.customer_id, c.first_name, c.last_name from rental as r inner join inventory as i on r.inventory_id = i.inventory_id inner join film_actor as fa on i.film_id = fa.film_id inner join actor as a on fa.actor_id = a.actor_id inner join customer as c on r.customer_id = c.customer_id where c.last_name = a.last_name;


select a.last_name, count(fa.film_id) from film_actor as fa inner join actor as a on fa.actor_id = a.actor_id group by fa.actor_id;


